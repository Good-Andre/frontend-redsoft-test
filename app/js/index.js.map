{"version":3,"sources":["index.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.js","sourcesContent":["'use strict';\n\nconst productList = document.querySelector('.main__gallery');\n\nlet cart = JSON.parse(localStorage.getItem('cartTestRedsoft')) || [];\n\nloadProducts(); // LOAD local storage\n\nfunction showLoader(spinnerWrapper) {\n  spinnerWrapper.textContent = '';\n  spinnerWrapper.insertAdjacentHTML(\n    'beforeend',\n    '<section class=\"sk-fading-circle\">' +\n      '<div class=\"sk-circle sk-circle-1\"></div>' +\n      '<div class=\"sk-circle sk-circle-2\"></div>' +\n      '<div class=\"sk-circle sk-circle-3\"></div>' +\n      '<div class=\"sk-circle sk-circle-4\"></div>' +\n      '<div class=\"sk-circle sk-circle-5\"></div>' +\n      '<div class=\"sk-circle sk-circle-6\"></div>' +\n      '<div class=\"sk-circle sk-circle-7\"></div>' +\n      '<div class=\"sk-circle sk-circle-8\"></div>' +\n      '<div class=\"sk-circle sk-circle-9\"></div>' +\n      '<div class=\"sk-circle sk-circle-10\"></div>' +\n      '<div class=\"sk-circle sk-circle-11\"></div>' +\n      '<div class=\"sk-circle sk-circle-12\"></div>' +\n      '</section>'\n  );\n}\n\nfunction hideLoader(spinnerWrapper) {\n  setTimeout(function () {\n    spinnerWrapper.classList.add('in-cart');\n    spinnerWrapper.textContent = 'В корзине';\n  }, 1000);\n}\n\nconst getProduct = function (spinnerWrapper, id) {\n  showLoader(spinnerWrapper);\n  let url = 'https://reqres.in/api/unknown/' + id;\n\n  function myFetch(url, callback) {\n    let xhr = new XMLHttpRequest();\n    xhr.open('GET', url);\n\n    xhr.onload = function () {\n      callback(xhr.responseText);\n    };\n\n    xhr.send();\n  }\n\n  function loadData(data) {\n    data = JSON.parse(data);\n    saveProduct(data.data);\n    hideLoader(spinnerWrapper);\n  }\n\n  myFetch(url, loadData);\n};\n\nproductList.addEventListener('click', function (event) {\n  let target = event.target;\n  if (target.classList.contains('gallery-item__btn')) {\n    const btn = target;\n    if (!btn.classList.contains('in-cart')) {\n      const id = btn.dataset.id;\n      getProduct(btn, id);\n    } else if (btn.classList.contains('in-cart')) {\n      btn.classList.remove('in-cart');\n      btn.textContent = 'Купить';\n      removeProduct(btn);\n    }\n  }\n});\n\nfunction loadProducts() {\n    const galleryItemBtns = document.querySelectorAll('.gallery-item__btn');\n\n    for (let i = 0; i < galleryItemBtns.length; i++) {\n      let btn = galleryItemBtns[i];\n\n      for (let i = 0; i < cart.length; i++) {\n        if (\n          cart[i].id ===\n          +btn.dataset.id\n        ) {\n          btn.classList.add('in-cart');\n          btn.textContent = 'В корзине';\n        }\n      }\n    }\n\n  // console.log('Корзина после загрузки', cart); // dev\n}\n\nfunction removeProduct(btn) {\n  let oldCart = cart;\n  cart = [];\n\n  for (let i = 0; i < oldCart.length; i++) {\n    if (\n      oldCart[i].id !==\n      +btn.dataset.id\n    ) {\n      cart.push(oldCart[i]);\n    }\n  }\n\n  // console.log('Корзина после изменения', cart); // dev\n  localStorage.setItem('cartTestRedsoft', JSON.stringify(cart));\n}\n\nfunction saveProduct(data) {\n  cart.push(data);\n  // console.log('Корзина после добавления', cart); // dev\n  localStorage.setItem('cartTestRedsoft', JSON.stringify(cart));\n}\n"]}